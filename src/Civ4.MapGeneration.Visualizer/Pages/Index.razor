@page "/"

@using Civ4.MapGeneration.Layers.Landmasses;

<h1>Civ4 Map Visualizer</h1>

@if (Dimensions != null && Landmass != null)
{
<div class="grid-container" style="
        display: grid;
        --grid-cols: @Dimensions.Width;
        --grid-rows: @Dimensions.Height;
        grid-template-rows: repeat(var(--grid-rows), 0fr);
        grid-template-columns: repeat(var(--grid-cols), 0fr)">
        @for (int j = Dimensions.Height; j >= 0; j--)
        {
            for (int i = 0; i < Dimensions.Width; i++)
            {
                var isLand = Landmass.Tiles.Any(t => t.Location.X == i && t.Location.Y == j);

                if (isLand)
                {
                    <div style="background-color:#2da84e; height: 50px; width: 50px">
                        (@i, @j)
                    </div>
                }
                else
                {
                    <div style="background-color:#1c52d9; height: 50px; width: 50px">
                        (@i, @j)
                    </div>
                }
            }
        }
</div>
}

@code {

    public Landmass Landmass { get; set; }

    public Dimensions Dimensions { get; set; }

    protected override Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            Console.WriteLine("Generating landmass");

            Dimensions = new Dimensions(10, 15);
            Landmass = Landmass.Build(Dimensions);

            StateHasChanged();
        }

        return Task.CompletedTask;
    }
}
